---
layout  : wiki
title   : 
summary : 
date    : 2020-07-14 11:16:22 +0900
updated : 2020-07-15 12:23:36 +0900
tags    : 
toc     : true
public  : true
parent  : 
latex   : false
---
* TOC
{:toc}

## Background



- 프로세서가 주어진 시간 간격에서 처리할 명령어 개수
    - KHz(초당 1천번), MHz(초당 100만번), GHz(초당 1억번)
- 프로세스 한 개의 클럭 올리려는 물리적인 도전은 전력 소모에 따른 열 방생 등의 이유로 한계
- 한 프로세스 내 여러 코어인 멀티코어 칩과 하위 클럭으로 성능 보완
- 일반적인 병렬화
    - 병렬화(Parallelism)와 동시성(Concurrency) 차이
        - 병렬 프로그램은 여러 프로세스들이 태스크를 동시에 실행
        - 동시성 프로그램은 여러 프로세스를 하나의 스케쥴러가 제어
            - 동시성 프로그램은 경쟁이 발생하면 CPU 스케쥴러가 제어

<img width="634" alt="1" src="https://user-images.githubusercontent.com/48748376/87383456-391a8780-c5d4-11ea-826e-0577bca95166.png">


## 설명

### 병렬 프로그래밍 통신

- 공유 상태(Shared state)
    - 프로세스 중 하나가 자원을 공유하는 유효하지 않은 작업을 하면 모든 프로세스에 영향?
- 메시지 전달(Message passing)
    - 공유 상태로 인해 발생하는 데이터 접근 제어와 동기화 문제를 피할 의도로 메시지 전달 사용
    - 실행 중인 프로세스에서 메시지를 교환하는 메커니즘
    - 각 메시지 교환에서 데이터를 복사
    - 장점
        - 데이터 접근 동시에 발생하지 않는다.
        - 로컬이나 분산환경에서 메시지 교환 가능
- 부모가 다른 프로세스 사이 통신
    - 네임드 파이프를 사용

### 병렬 프로그래밍 문제

#### 교착상태(Deadlock)

- 두 개 이상 작업자가 자원이 해제될 떄까지 무한히 기다리는 현상

#### Starvation

- 무거운 프로세스가 끊임없이 CPU를 소모해 다른 프로세스는 기회를 얻지 못한다
    - 프로세스 순위 정책에 기인

#### Race Condition

- 프로세스가 순서에 의존하다가 동기화 메커니즘이 없어 직면하는 문제
    - 대규모 시스템에서 문제의 소지 다분
- 병렬 프로그래밍 특성인 비결정성 때문에 동기화는 필수

### 프로그래밍 도구

- threding
    - 저수준 모듈 `_thread`의 추상화 계층을 제공하는 `threading`
- multiprocessing
- parallel python
    - 최적 구성 자동 감지
    - 실행 시간별 작업자 프로세스 변경 가능
    - 동적 부하 분산
    - 무정지
    - 계산 자원을 자동으로 발견
- 분산 태스크 큐(샐러리)
    - 분산 시스템에 적합
        - multiprocessing, eventlet, gevent

### GIL

- Cpython 내부 메모리를 보호할 목적으로 스레드 동시 접근 메커니즘을 구현하지 않았다.
- 스레드를 사용하면 CPU 바운드된다
    - 예: I/O 스레드는 GIL 범위를 벗어난다

### 병렬 알고리즘

- 분할 정복 기법
    - 복잡한 문제의 단위를 발견하고 해결할 떄까지 영역을 재귀적으로 쪼개는 과정을 수반
- 데이터 분해
    - 작업자들이 생성한 결과들의 상관관계를 확립하기 위해 메시지 전달 패턴이나 공유 상태 표준을 통한 교신 필요
- 파이프라인으로 태스크 분해
    - 순차 기법과 달리 파이프라인 기법의 각 단계는 병렬로 동작하는 자신만의 작업자를 소유
- 프로세스 매핑
    - 독립 태스크 식별
    - 데이터 교환이 필요한 태스트 식별
    - 부하 분산
        - 많은 태스크를 단일 작업자에게 그룹화하면 통신 과부하를 줄일 수 있다.
        - 그러나 처리 능력을 모두 쓰지 못하는 유휴가 증가할 수 있는데 병렬 프로그래밍에서 유휴는 바람직하지 않다.

## Link

- [파이썬 병렬 프로그래밍](http://www.yes24.com/Product/Goods/32946076)

